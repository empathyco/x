name: Enables Cache
description: Enables the cache for different tasks
outputs:
  cache-node-modules:
    description: "Node modules cache"
    value: ${{ steps.cache-node-modules.outputs.cache-hit }}
inputs:
  task_name:
    description: Task used to check if the cache should be used
    required: true
runs:
  using: "composite"
  steps:
    # Using lerna, it is recommended to cache the whole node_modules folder https://github.com/actions/cache/blob/main/examples.md#node---lerna
    # but this is not the standard, normally, only the node_modules/.cache should be cached. Also, as cypress image is used, node is already
    # preinstalled, the expected action `setup-node` is not used.
    # https://docs.github.com/en/actions/using-workflows/caching-dependencies-to-speed-up-workflows#about-caching-workflow-dependencies
    - name: Cache node modules
      id: cache-node-modules
      uses: actions/cache@v3
      with:
        path: '**/node_modules'
        key: node-modules-${{ hashFiles('**/package-lock.json') }}
    - name: Cache eslint
      if: ${{ inputs.task_name == 'lint' }}
      id: cache-eslint
      uses: actions/cache@v3
      with:
        path: .eslintcache
        key: eslint-${{github.sha}}
        restore-keys: eslint-
    - name: Cache Jest
      if: ${{ inputs.task_name == 'test:unit' }}
      id: cache-jest
      uses: actions/cache@v3
      with:
        path: ./tmp/jest
        key: jest-${{github.sha}}
        restore-keys: jest-
    - name: Cache Cypress
      if: ${{ inputs.task_name == 'test:e2e:ci' || inputs.task_name == 'test:unit-cypress' }}
      id: cache-cypress
      uses: actions/cache@v3
      with:
        path: ~/.cache/Cypress
        key: cypress-cache
